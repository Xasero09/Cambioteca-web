<header class="main-header">
  <div class="header-content">

    <div class="logo-and-home">
      <a routerLink="/" class="logo">
        <img src="assets/icon/cambiotecasimple.png" alt="Logo Cambioteca">
        <span>Cambioteca</span>
      </a>
    </div>

    <!-- Men√∫ de Usuario Logueado -->
    <ng-container *ngIf="isAuthenticated$ | async; else loggedOutMenu">
      
      <nav class="main-nav">
        <a routerLink="/catalogo" class="nav-link">Cat√°logo</a>
        <!-- üëá A√ëADIDO AQU√ç üëá -->
        <a routerLink="/puntos-encuentro" class="nav-link">Puntos de Encuentro</a>
        <a routerLink="/propuestas-recibidas" class="nav-link">Propuestas</a>
        <a routerLink="/chat" class="nav-link">Mensajes</a>
      </nav>

      <div class="user-menu">
        
        <button class="user-greeting-button" (click)="toggleDropdown()" *ngIf="currentUser$ | async as user">
          <span>¬°Hola, {{ user.nombre_usuario }}!</span>
          <svg class="chevron" [class.rotated]="isDropdownOpen" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" fill="currentColor">
            <path d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"/>
          </svg>
        </button>

        <div class="dropdown-content" *ngIf="isDropdownOpen">
          <a routerLink="/perfil" (click)="toggleDropdown()">Mi Perfil</a>
          <a routerLink="/mis-libros" (click)="toggleDropdown()">Mis Libros</a>
          <a routerLink="/historial" (click)="toggleDropdown()">Historial</a>
          
          <div class="dropdown-divider"></div>
          
          <button class="dropdown-logout" (click)="onLogoutClick()">
            Cerrar Sesi√≥n
          </button>
        </div>
      </div>
    </ng-container>

    <!-- Men√∫ de Invitado -->
    <ng-template #loggedOutMenu>
      <nav class="guest-nav">
        <a routerLink="/" class="nav-link home-link">Inicio</a>
        <a routerLink="/catalogo" class="nav-link">Cat√°logo</a>
        <!-- üëá A√ëADIDO AQU√ç üëá -->
        <a routerLink="/puntos-encuentro" class="nav-link">Puntos de Encuentro</a>
        <a routerLink="/login" class="nav-link">Iniciar Sesi√≥n</a>
        <a routerLink="/registro" class="btn-register">Registrarse</a>
      </nav>
    </ng-template>

  </div>
</header>